sort_len(byref str, del := "`n", shortFirst:=true, omitEmpty:=true, init:=false){
	; source, see: 'c souce\sort_len.c'
	local k, i, raw, r
	static flProtect:=0x40, flAllocationType:=0x1000 ; PAGE_EXECUTE_READWRITE ; MEM_COMMIT	
	; binary code:
	static raw32:=strsplit("1398167381,9235585,2223702016,40996,615811840,164,2888084619,1711276032,251672707,247684,1048798720,3179548416,2231369731,3045330925,3338665987,3355714628,3338665984,9220,2499739648,46116,2311095552,608471495,2441350944,3338665987,3355714628,3338665984,9220,2499739648,46116,2311095552,254026820,663684,608487168,51204,604292864,0,3022296319,2231369728,264341952,655492,2382006528,2089488479,1099768868,608995600,609519912,281510688,2467289401,264387009,3389637267,606356537,968987407,254289020,3356082323,2215625348,4332,606358667,1552668985,2467242020,268122562,3255353491,282231823,3632857088,3239043203,3640066792,3800285833,4102295299,3338665986,3,3352267008,1,608996096,33194792,455,2215575552,4310,3338926723,1091,1204224000,4,71419648,0,284591375,1137115136,8,138921728,0,955,138528512,0,12223,3323904,3492347904,472138889,11960,3251644672,3229811432,608471297,48283928,337921161,539249803,9766029,1711276032,2378231567,1284178196,688858148,62980354,254288964,286195985,1109987072,1091637008,1074859792,1109987088,1091637024,1074859808,1109987104,1091637040,1074859824,1109987120,1091637056,1074859840,1109987136,1091637072,1074859856,1109987152,1091637088,1074859872,1109987168,1091637104,1074859888,2183729008,128,2155942159,251658240,8421393,688848896,36994,2165378816,144,2424312079,251658240,10519081,286195712,41089,2148601600,160,405044355,253064460,11567657,286195712,45185,2148601600,176,337921163,1144768297,344792100,1962510616,608471915,612141864,33129248,606362763,9897159,3338665984,37636,80150528,144,21138688,80167540,135,612141824,46301992,3338860931,33540,80150528,135,2334225408,3340772420,36868,1149960192,80159780,144,608471808,2416232232,0,28896645,3120562176,0,3351594255,4203588,3338665984,842802244,2298478592,608471495,2213579092,1153896416,6180,1153892352,3288100,3906011136,3766737143,267925767,3341403975,1149879177,1200440356,612141560,65585496,2298593411,3244041284,3984917472,1612989577,268387725,3347694148,3221346441,1149886249,4026623012,1277459593,1344554121,823150221,612141567,608471344,112660328,807697547,2357975857,40996,608487168,4294967068,1149855487,3062699044,0,2367620237,3071230220,3229967873,996548468,1947477060,29590398,2686749835,2365587456,210575108,28774209,1975551334,29372897,608487363,284,266044672,32645,612666112,160,405030019,1015244289,2215575672,1495,3247042305,2422645483,3296844593,140,1583077513,3351469407,806626372,3338665984,202908740,3204448256,50,472138951,50,1776933681,838860797,29393856,1091876623,1175730534,261784847,3308847104,261260815,2238054400,971142610,1954877381,3925868543,4294967161,807697545,740588683,337927305,2198862649,1697,337935499,1009009803,210630713,4294966461,3343323135,1009009801,1076118667,1108342841,608471495,608471872,2311586088,2335712324,29591808,2311555576,2335450180,2367956036,16792916,608471496,956336968,1132597186,2231369734,1347008,1149962613,3892384804,50336909,2367693900,1418269188,1149857828,25887780,1814318217,4280550537,11805844,3229941760,237863951,1418395648,1284206628,2089511972,25774116,3263764361,337921163,807697547,1210338441,1149878273,2223704100,40996,2013564160,69485705,2304377997,2499748868,48164,2344649984,256386124,909956,608471808,17402676,18124224,1814316169,337921163,135808141,960562317,1150488518,1413171236,3054463012,256386140,3272130707,204768271,4253220864,730205966,2332033036,2235835516,226758655,251658249,4286777015,42558977,223052815,1149960192,3071226916,3229811294,50299649,1711281293,255925385,874628,1186402048,67076868,289704294,1015287554,251658253,2198226615,2305164543,251924804,860292,1186402048,100631304,289704294,75763462,251658253,2198488759,2305165311,252186948,843397,1186402048,1149855244,129632785,956301312,257172604,58244,612139776,1685456460,1814316171,1680098307,807697547,337927307,1814316231,0,1881429129,1149880321,1149978660,1418416164,1149454372,2197908516,258347200,2213568623,286200002,1418326114,1418414116,1413180452,3664927780,1612989579,1881429131,807697545,337927305,1144635905,2020890660,874806411,1444722447,3489790089,1092389222,956383885,258045637,21372087,478766840,37915969,1349961017,1176286991,2305226753,1116553500,1992636675,481759039,1727529286,2369854601,3308848194,3071225462,4160833052,1092389222,956646029,253589189,21372087,478766840,105024833,209110329,1175762703,874791939,1091864934,337927307,941900939,402778881,807689217,472153219,1652822015,2348810236,11019396,3229941760,116622351,2223702016,45092,264275200,739973,608471808,264275224,736900,759467264,614238976,160,2894713393,44068,608471296,608471856,608471320,273059092,472138889,2366653325,3325628972,1002541839,253502556,3238576275,108233743,3162701824,44068,2249133568,1637,1143229579,2215627141,835,2198255375,2305163769,3716419331,251658250,2197964471,2305164025,2215576131,2788,71743247,1711536515,251937673,706436,1186402048,83460870,105089382,182879247,3071213568,4186114118,1133078021,3380875016,251658250,2198488759,2305165305,2232355395,2732,205960975,2305216393,129502275,956301312,257172604,65924,612139776,1551238732,1680112779,1344556171,874792135,0,941900937,3154374401,40996,615287552,172,695144294,2198914947,20194372,2333131139,255075396,1005612817,1918641220,612142051,608471904,615287096,172,2084173825,2215598116,158,1178384143,2197949581,2218328512,44068,615287552,160,1300007270,260011520,2370190519,2305163788,2365607292,2352677192,44068,258437888,21904567,2089379537,1217200205,613169410,172,3071234166,3506523708,1300007270,55086336,2888076345,1979711488,1018629945,1724973390,5078153,956582029,11281548,578158592,1312601871,17154179,612645329,172,1300007270,252409344,21367991,1284073168,2483224645,44068,610009856,611091248,2232353044,4294966840,405042315,2888084619,3338665984,1582148,251658240,210630063,608471862,610044736,4286090556,956427139,3817213919,2298478599,11281580,1284177920,4119406628,606368907,1988957675,666668288,0,956416899,2944798687,2332033031,3229982212,76279412,608995737,2311061780,2332566596,2334139460,1149868036,2223703076,40996,1745128704,4280550537,12330132,3229941760,140215311,1284177920,738399268,2343693209,2235573340,1082462171,2348810237,11543692,3380936704,3526428020,2333116774,2333615196,2234262596,813961152,3338665992,3417156,3338665984,1320004,3338665984,3679300,822083584,610044406,612141848,2347993388,2334139500,12068020,3062693888,0,10310795,91542149,4280554633,29590486,3966958393,405036171,539247755,4280550537,12067988,1149960192,76097572,613744420,184,606356619,4280550537,12067988,1149960192,3229956132,76089972,613744420,184,337921163,175423621,4280550537,12067988,1149960192,3229955108,4183852047,76152831,613744420,184,4294529513,4294949887,1153957887,13348,1153892352,5156,1153892352,14372,1153892352,10276,1153892352,3288100,820576256,838860799,612139968,2265908812,4294966580,2332473103,10495164,4253614080,1459915110,440,4254460160,1275330559,294330404,4294573033,608472063,4245982496,0,69489801,874796169,4280550537,11805844,1418395648,3280548900,941900937,606356619,69489801,1210340489,4280550537,11805844,1284177920,1418405924,1149847588,210318372,609519908,613744388,180,3247037317,137987087,1149960192,3229955108,137200655,3380936704,136676367,4169728000,960445581,612141560,797118280,2332033026,2368480348,1088788,3744006144,606370953,2381347469,2089367812,3280545828,941900939,539253897,3275345921,941907083,608473871,2382037360,1552486716,4214844452,2015657097,874806411,608473871,612107124,1555435304,1544188964,3342430244,1881439369,1814330507,608473871,609485692,2312583476,259269716,1141555347,3626073124,606362763,252574595,3498361495,119178255,1418395648,1413052452,1149988900,2467263524,608451010,3230863136,2215625224,1788,3750361737,2299519619,48808400,3766737143,2346203395,254551132,4286969926,539262089,1584716425,539262083,608471809,22252856,874806411,9962695,3338665984,40708,80150528,153,2201449472,52438140,9438407,3338665984,38660,80150528,145,39030016,80156789,144,2533672704,0,9503943,2365587456,2089485139,1149968420,1552622628,1153897508,8228,1418264576,4163468324,606356617,3238324355,3229811432,608471297,48284012,1881425033,673465483,2344092813,20456572,612141511,612141864,29819188,612141512,612141940,608471344,2344628600,1713906772,1724509967,2211639055,18883652,34351375,1948537995,34869519,2015646859,34869519,539251851,990953603,1919689812,608472014,609520496,612141436,610044208,969015572,1948525636,21138785,1210336313,941915275,874798219,9897159,3338665984,37636,80150528,145,3342562816,34564,80150528,131,2164573952,0,956449421,1984439364,612141853,2265237304,0,874806411,8848583,3338665984,33028,2089484288,2084125732,2215586852,1276,874792075,673467529,606356617,941900939,539247753,1210336395,740574345,4294343657,615287807,172,3071262769,2305181196,3229827852,2009413889,615287281,172,4294640105,608472063,610044732,4286090560,956427139,2508394463,2298478597,10757300,2894659584,44068,608487168,20,611617536,611093284,2198334248,3745055211,76238195,1958774174,2638515186,613190400,160,1149878273,1149962276,76226596,608471448,608471812,1090817300,4280550537,12330132,3229941760,59474959,1284177920,1275134109,3018527780,1995035185,2348810231,2333353028,10757300,2894790656,44068,609520384,822588,673465483,4294951553,2349023231,40996,2417790208,3895001995,1149878273,1149962276,76226596,604801424,69485705,3156514047,2231369728,646188992,2332033027,2333353028,11543740,3895001088,4286907139,337921161,42370319,1552613376,3682932772,32474127,3347644416,2966669,2686751883,2298478592,11281580,1149829120,2223715364,40996,2015137024,2299545229,2300322884,272862687,1547425577,2467240996,264649153,3238576275,49906703,3162701824,44068,2249133568,747,1143229579,2215627141,408,2198255375,2305163769,2424573699,251658243,2197964471,2305164025,2215576131,1027,71743247,1711536515,251937673,255620,1186402048,83460870,105089382,63538191,3071213568,4186114118,1133078021,2894335752,251658243,2198488759,2305165305,2232355395,848,205960975,2305215881,129502275,956301312,257172588,64132,612139776,1433798220,1680112643,1344556171,2888084619,3338665984,3155012,2298478592,20456516,1863280343,281510705,2198913411,19932228,807683211,4034334991,1545880635,2089542514,1149984804,2894673956,44068,972554496,257434748,40580,608996096,1018629908,2210464070,2218328512,44068,1015637504,2156269386,2332033024,252978284,2303081655,1723924969,2370452617,2352546120,44068,258242048,21904567,1015637737,38309194,2888076345,1979711488,1018629966,1726546254,2370452617,2352546632,44068,255358464,21904567,1015637737,71863626,2888076345,1979711488,1018629922,96502606,2218387713,44068,1015637504,252474954,54922423,1712596036,2336361609,11281596,1543700480,2080453668,1820529700,251729956,4294851205,3923456511,4294965463,2089009201,252070948,4294893447,112660479,337935499,2047117670,440,4282247424,4002021375,2888084619,2365587456,1418409484,1149976612,2349017124,40996,4290937088,2369781759,59478044,3221350441,136594569,539247755,2307916939,1149838348,2499740708,48164,264275200,40068,612666112,176,2215624837,4294965335,855895593,337933449,2686747787,2332033024,823403644,210331337,4164544888,2089549823,1552625700,3224441892,1175238415,1108117862,956416131,2314303429,2301633660,3910411356,4294964520,539251851,673467531,1552662577,1988961316,666668288,0,8520903,3338665984,33540,80150528,129,29393664,1966274691,4040878563,834666495,3137339392,1,4293875945,4294949887,3303669759,2348810231,2300585028,2499748868,47140,608471808,604277032,3089405183,2332033024,3911459908,4294965330,12479,178944,451477504,2348810223,11281580,3224436736,1175238415,1124895078,956416131,2314302184,11281580,1961426944,838860798,3925225929,4294964929,440,3922692352,4294964603,952,3922692352,4294964591,696,3922692352,4294964579,1720,3922692352,4294964567,1464,3922692352,4294964555,1208,3922692352,4294964543,740574347,1149878273,4125703204,3137339386,6,4294125289,113407,485031936,3137339379,5,4294120169,310015,149487616,3137339379,3,4294115049,178943,4108910592,3103784946,1,3370765705,2348810236,3910935644,4294964923,1720,3922561280,4294966451,740574347,807697547,337927307,941905035,8520903,2332033024,3342083156,33284,80150528,129,29393664,1210336313,2089409141,1552494628,1273566244,3103784954,5,1760152969,3103784956,4,1558826377,3103784956,3,1357499785,3103784956,2,1156173193,2348810236,2301371476,2333353036,2233214044,1350897618,3925868534,4294964864,1153943857,5156,3263758336,4294633449,649367039,0,2215626041,4294963185,265454950,4293910148,2344813055,10495116,2716401664,2432696303",",")
	static raw64:=strsplit("1447122753,1413567809,1398167381,2834071880,1711276032,1207974275,2303249289,3330885079,265193796,223108,981689856,1568935680,1157627907,2215627141,852,2428160305,4278190081,18359444,2236088320,3314108864,54166543,3375431680,51386,613744384,280,1237353800,2215626633,2079,3367684401,4278190080,18359444,2236088320,3280554432,608471368,8654632,1224736776,1225803661,26250637,961085440,3632876739,1220711183,1225834627,2467284793,1287784896,88660105,200,1103444297,1237357327,2467285817,3221832896,2215625348,2616,3364326729,1224736768,2467284281,3476638146,146838287,495194050,1090519050,252233206,177540,1170688256,0,28918016,1090519040,1991,3091267584,49,247617,3120562176,1,3578039625,4010763776,4010763977,3804317888,210585858,3657518103,838370113,252193039,252725289,286195985,1210650370,1210650400,1091637040,1108414224,1210650384,1210650432,1091637072,1108414240,1210650400,1210650464,1091637104,1108414256,2284392240,128,2424842511,251658240,255869201,255869457,10520617,688848896,45192,1091636992,1108414288,2284392272,192,3498584335,251658240,257966353,257966609,14714921,688848896,61576,1091636992,1108414320,2284392304,256,277358863,251658241,8421649,286195712,32898,2284392192,288,814229775,251658241,9470225,286195712,36994,2284392192,320,1351100687,251658241,10518801,286195712,41090,2284392192,352,1887971599,1090519041,254820749,11567377,286195712,45186,1153911040,197,3342925824,34564,3342925824,33540,561250304,2290468681,1,1090519040,12879815,0,3342925824,50307,0,3103163648,1,186,3326414592,615811396,256,1143227591,0,2223620489,36900,4169746432,3339706499,843064388,3338665984,842277956,1207959552,2303518929,1211638892,3766737143,264780039,3240739143,2311293249,2371626052,2357852225,35876,65585408,2298593411,8922244,3770744832,2314634499,8660100,1183645696,3259240447,2313433413,3632874689,702230853,3221309633,1222543685,1881425033,2314731848,1213736012,2015642761,273124680,608471368,3071231072,4290593039,838860799,2149519341,0,738495809,264276297,1715668151,427081861,3359196262,3313724020,76366081,3230222636,1124382479,1975551334,29372903,29180357,2231369728,1148614125,2202132617,2204500422,251675452,277124,4093722880,2422649579,1155805509,2169036937,43204,1600019200,1096565085,1096696157,826655583,850936265,822083584,4251118034,258408447,17439,1217249329,344801537,3364440072,1393866511,1326725478,145130767,3459842048,144606735,2238054400,970683858,3951064526,611072902,3632467764,2332033028,1145054276,1224689037,673467531,894733636,266877184,1149879623,1149976612,3896067108,2311406095,1245979716,8717453,1207959552,2370683137,2336491292,1284065289,2336313380,344802051,264386826,291970,2378204416,2336751628,1127752772,1276253325,2552536201,1140850688,2485423241,1140850688,2149880969,1241513984,1220543629,2312193295,1214784596,2303250945,1212687428,2499741835,71716,3229960192,129205263,2336751616,2336760908,1281893460,2552536203,1140850688,2485423243,1140850688,2149880971,1207959552,2302738825,3800646675,613714244,128,1208782154,608995660,344803432,1150110803,2499739693,75812,3229960192,608996172,2492154984,32804,1384386304,1207959559,1210336395,692358477,210585864,479022121,277563401,1107594574,436505930,1103575372,1220645647,1612989499,3230863169,264308805,397444,218006272,101156367,1821048832,3984940068,83461135,256114688,4253222839,2302961153,3632533248,1140850694,38778639,21073228,1258487171,1711277197,1108117830,114394127,256114688,2198095799,1147536381,33703049,112428047,256114688,2198226871,1147536637,67257481,108168207,256114688,2198357943,1147536893,100811913,106202127,256114688,2198489015,1147537405,134366345,106202383,256114688,1712080823,38046020,505866,2336489472,9446532,960757760,257696836,59524,612139776,1316357720,608996172,3224454512,422350155,610044748,3375449464,1725235528,74387267,3246604547,286212609,1224738116,1141948547,2284096569,1996488704,2626372834,33828,3623961600,614218564,140,9667599,2302738432,29393856,213323590,3355527495,1181140537,1984040073,3230220668,213323590,3355527495,210323046,1082999874,3325641729,256271222,1229393079,1181140993,1145179273,1140998285,1299629625,213323590,3355527495,210323046,1082999874,3325641731,256259958,1229393079,1181140993,1145179273,1141129357,561432121,213323590,96502599,969408841,2303092464,225657356,79105860,3355527239,76104806,1149978690,21319716,268518612,4294804289,4233331727,2303066111,1821068531,2336503844,16786612,2235891712,3229880310,2332033026,17835180,3984916480,82085135,826605568,3682944448,265914693,316804,3263775744,778485809,8658703,0,347541316,3229829191,2211547393,3325624770,344540262,1105819467,2202136577,3514106345,3736014660,1171818820,2303253297,3221309637,1076133003,611617604,32473924,32408385,267860292,259971,3968418048,610044228,3958737208,29852428,267860292,249731,1173915904,1216814219,8721549,1157627904,3782531973,611617608,3590408232,3310652233,3767092224,1208388420,1296239757,2499788801,75812,3229960192,70353935,54788096,2343758630,1162093636,2337076105,1144530028,2405515,2231369729,193269696,1157627903,270840971,1157627905,125105797,1726230853,1159956804,1150016649,3229955108,62882831,3343384576,3679300,1157627904,3979474481,874804363,616336200,288,2422659889,3712781129,3380955136,3623813748,29590344,3967278649,4293495116,18883732,2336751616,4280820812,18883732,2303459328,613744633,288,1961723208,3918088202,539268351,1291845633,175437445,4294019404,18883732,2336751616,1211638852,2215624837,4294966035,4290873672,18883732,82378752,1107296251,4294967228,1153911039,14372,826605568,1223504374,673465543,0,874792135,50,4294924265,1149978879,2370451492,2303246340,1212687428,3941138571,2348810235,1211376708,941902987,822596,3440676170,0,613189956,128,608995660,613744456,280,608996172,4186524744,608471368,479022696,141,3666430976,610044236,613744464,280,610044748,1149847632,2336770084,1277699148,2499795593,71716,1418415104,2337040420,1296573516,2215629445,781,264865101,197764,3229960192,50037775,1284177920,2336502820,8397956,960757760,1942653377,2211547425,960561602,80169424,202,80167168,137,2282014464,0,1418452853,1413038116,2215588900,636,1221560653,673465481,609519948,1149846584,1156133924,2348810234,1145316460,1076130955,1090645379,1140977283,2249192761,716,1221144901,4163157129,1140850688,941907081,1106741572,2302998153,1712384974,8658703,0,956427651,2304669437,210453992,613239943,133,3380954368,55371380,1227367524,12932235,2370367625,2336572172,21832708,613744576,296,264275272,114308,872628480,834267940,612139968,2265908824,4294966176,1711781647,3091858569,1,4294702313,1156680191,941907083,1106676036,2336816777,16262332,2303262720,3372304585,608471880,3640739880,610044228,1284064320,2336962596,1090581844,4294967228,747457279,1166754992,4029235456,4290773325,19408020,2236088320,1266945984,1157627901,941902987,612666180,272,610044740,4046012736,5047108,264275269,59525,3682944256,2302946932,1723871690,8658703,0,79105860,3229829191,2211547393,3325624770,76104806,1105819467,2202136833,3530883563,3924046149,4294966510,609520456,2428514600,1162135369,0,80167168,7,33867520,0,79725384,13122888,3698655232,4294395113,265433599,1716980919,1213205641,956416643,3924850646,4294966133,610044740,3767092280,2303258249,3221309637,612141896,1552499752,2370320420,2336949004,1090581844,4294967228,1015892735,126567607,1307584833,2499788801,75812,3229960192,4234183695,2336555007,17835156,2336489472,1161307228,2215629445,4294966343,1105824065,54849833,1724461327,1259112770,4294718185,3918089471,539268351,1207959553,673467531,539268351,1275068417,2499803529,73764,4155369728,3224502271,1642720561,1107296251,4294967228,4227656191,96010239,3909091328,4294965702,1208,4189907200,112787455,3909091328,4294965682,874794123,1284098305,1978220580,3103784957,1,4294547945,243967,2414411776,3103784953,2,4294542825,3934864895,611093324,3565765944,4294681065,609520639,3582544948,1240107333,2337064585,1161307244,2303513737,2235049036,2575634386,3925868539,4294966200,4202255,2215626297,4294964971,265454950,4294367876,3922002431,4294964904,826657073,4258195913,2425421823,2425393296,2425393296,2425393296",",")
	; Functions:
	static pr:=DllCall("Kernel32.dll\GetProcAddress", "Ptr", DllCall("Kernel32.dll\GetModuleHandle", "Str", "MSVCRT.dll", "Ptr"), "AStr", "realloc", "Ptr")
	static fr:=DllCall("Kernel32.dll\GetProcAddress", "Ptr", DllCall("Kernel32.dll\GetModuleHandle", "Str", "MSVCRT.dll", "Ptr"), "AStr", "free", "Ptr")
	static cpy:=DllCall("Kernel32.dll\GetProcAddress", "Ptr", DllCall("Kernel32.dll\GetModuleHandle", "Str", "MSVCRT.dll", "Ptr"), "AStr", "memcpy", "Ptr")
	static bin:=sort_len("","","","",true) ; init.
	if init {
		if !(pr*fr*cpy)
			throw exception("Failed to retrieve function pointers: " pr "`t" fr "`t" cpt ".")
		bin:=DllCall("Kernel32.dll\VirtualAlloc", "Uptr",0, "Ptr", (raw:=A_PtrSize==4?raw32:raw64).length()*4, "Uint", flAllocationType, "Uint", flProtect, "Ptr")
		for k, i in raw
			NumPut(i,bin+(k-1)*4,"Int")
		raw32:="",raw64:=""
		return bin
	}
	;return DllCall(bin, "ptr", &str, "ptr", &del, "int", shortFirst, "uint", strlen(del), "ptr", pr,"ptr", fr,"ptr", cpy, "ptr", registercallback("mb", "f cdecl"), "cdecl") ; db
	r:=DllCall(bin, "ptr", &str, "ptr", &del, "int", shortFirst, "uint", strlen(del), "int", omitEmpty, "ptr", pr,"ptr", fr,"ptr", cpy, "cdecl")
	if omitEmpty && r
		varsetcapacity(str, -1)
	return r != -1 ; 0 on fail, 1 on success
}
